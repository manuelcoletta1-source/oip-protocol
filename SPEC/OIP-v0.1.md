# OIP v0.1.0
## Operational Identity Protocol
Deterministic Attribution and Verification for Autonomous Systems

Status: Draft Reference Specification  
License: Apache-2.0  
Version: 0.1.0

---

# Abstract

Operational Identity Protocol (OIP) defines a minimal deterministic framework for binding operational identity to verifiable action events generated by autonomous and AI-driven systems.

It enables:

- cryptographic attribution of actions  
- tamper-evident event chains  
- fail-closed verification  
- forensic reconstruction  
- auditability for safety-critical systems  

OIP is designed to be vendor-neutral, transport-agnostic, and infrastructure-independent.

---

# 1. Scope

OIP applies to systems capable of autonomous or semi-autonomous action:

- robots and industrial automation  
- autonomous vehicles and drones  
- AI agents and runtimes  
- cyber-physical infrastructure  
- control systems and decision engines  

OIP defines:

- Operational Identity Object (OID)  
- Action Event Object (AEO)  
- deterministic hashing and signing rules  
- append-only chain model  
- verification outputs  
- fail-closed logic  

Out of scope:

- policy enforcement  
- transport layer  
- registry governance  
- commercial certification  
- network topology  

---

# 2. Design Principles (Normative)

1. Deterministic verification  
2. Cryptographic attribution  
3. Minimal disclosure (hash-only payloads)  
4. Append-only event chaining  
5. Fail-closed validation  
6. Vendor and hardware neutrality  
7. Local-first operation (no cloud required)

---

# 3. Cryptographic Requirements (Normative)

## 3.1 Hash Function
SHA-256 MUST be supported.

All digests MUST be SHA-256 hex encoded (64 lowercase hex characters).

## 3.2 Signature Algorithm
Ed25519 MUST be supported.

Public keys MAY be encoded:
- base64
- hex

Signatures MAY be encoded:
- base64
- hex

---

# 4. Canonical JSON Determinism (Normative)

All hashing and signing MUST use canonical JSON.

Canonical JSON MUST:

- be UTF-8 encoded  
- use lexicographically sorted keys  
- contain no insignificant whitespace  
- reject floats, NaN, Infinity  
- reject non-deterministic types  

Fail-closed rule:  
If canonicalization cannot be guaranteed → verification MUST fail.

---

# 5. Operational Identity Object (OID)

OID defines the cryptographic operational identity of an entity.

## 5.1 Required Fields

| Field | Type | Description |
|------|------|-------------|
oid | string | unique identifier |
public_key | string | Ed25519 public key |
manufacturer_id | string | vendor or operator |
firmware_hash | string | SHA-256 firmware/runtime |
created_at | string | ISO8601 timestamp |
status | string | ACTIVE / REVOKED / SUSPENDED |

## 5.2 Optional Fields
model_hash | SHA-256 digest of AI model

## 5.3 Status Rules
ACTIVE → valid for verification  
REVOKED → MUST return REVOKED  
SUSPENDED → MUST return INVALID  

---

# 6. Action Event Object (AEO)

Represents a single attributable action.

## 6.1 Required Fields

| Field | Description |
|------|-------------|
event_id | deterministic SHA256 event hash |
oid | identity reference |
timestamp | ISO8601 |
sequence | monotonic integer |
prev_event_hash | previous event_id or null |
action_type | action descriptor |
risk_level | R0–R5 |
input_digest | SHA256 |
decision_digest | SHA256 |
state_digest | SHA256 |
firmware_hash | must match OID |
model_hash | must match OID if present |
signature | Ed25519 signature |

---

# 7. Deterministic Event ID (Normative)

To eliminate circular dependency:

Define EventBody as the AEO excluding:

- event_id  
- signature  

Then:

event_id = SHA256( CanonicalJSON(EventBody) )

This rule is mandatory.

Any deviation MUST result in INVALID.

---

# 8. Signing Rules (Normative)

Signature MUST be computed over:

CanonicalJSON(EventBody)

Using Ed25519 private key corresponding to OID public_key.

If derived public key does not match OID → fail-closed.

---

# 9. Chain Model (Normative)

Each event forms an append-only chain per OID.

Rules:

1. sequence starts at 1  
2. next sequence = previous + 1  
3. prev_event_hash must equal previous event_id  
4. OID must remain constant within chain  

If any rule breaks → INVALID.

---

# 10. Verification Engine

Verifier MUST output exactly one:

VALID  
INVALID  
INCOMPLETE  
REVOKED  

## VALID
All checks pass.

## INVALID
Any deterministic mismatch:
- bad signature
- hash mismatch
- chain break
- firmware mismatch
- model mismatch

## INCOMPLETE
Missing dependencies:
- OID not available
- required fields missing
- malformed canonicalization

## REVOKED
OID status = REVOKED

---

# 11. Fail-Closed Requirements

Systems MUST NOT treat non-VALID events as trusted.

Recommended responses:
- log locally  
- raise alert  
- safe mode  
- block actuation for R3–R5  

---

# 12. Security Properties

Mitigated:
- log tampering  
- identity spoofing  
- replay  
- hidden rollback  
- forensic manipulation  

Not fully mitigated:
- physical hardware compromise  
- key theft without revocation visibility  
- sensor spoofing pre-digest  

---

# 13. Optional Anchoring

For high-risk events R3–R5:

Event_id MAY be anchored to:
- append-only registry  
- transparency log  
- public ledger  

Anchoring not required for protocol validity.

---

# 14. Interoperability

Transport is out of scope:
CAN  
DDS  
HTTP  
MQTT  
local file  

All valid if deterministic rules respected.

---

# 15. Versioning

Version format:
MAJOR.MINOR.PATCH

0.1.0 = first deterministic reference release.

Backward incompatible changes require MAJOR increment.


---

