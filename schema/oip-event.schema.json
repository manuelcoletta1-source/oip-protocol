{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://oip-protocol.org/schema/oip-event.schema.json",
  "title": "OIP Action Event Object (AEO) Schema",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "event_id",
    "oid",
    "timestamp",
    "sequence",
    "prev_event_hash",
    "action_type",
    "risk_level",
    "input_digest",
    "decision_digest",
    "state_digest",
    "firmware_hash",
    "model_hash",
    "signature"
  ],
  "properties": {
    "event_id": { "type": "string", "pattern": "^[a-fA-F0-9]{64}$" },
    "oid": { "type": "string", "minLength": 8, "maxLength": 128 },
    "timestamp": { "type": "string", "format": "date-time" },
    "sequence": { "type": "integer", "minimum": 1 },
    "prev_event_hash": { "type": ["string", "null"], "pattern": "^[a-fA-F0-9]{64}$" },
    "action_type": { "type": "string", "minLength": 1, "maxLength": 64 },
    "risk_level": { "type": "string", "enum": ["R0", "R1", "R2", "R3", "R4", "R5"] },
    "input_digest": { "type": "string", "pattern": "^[a-fA-F0-9]{64}$" },
    "decision_digest": { "type": "string", "pattern": "^[a-fA-F0-9]{64}$" },
    "state_digest": { "type": "string", "pattern": "^[a-fA-F0-9]{64}$" },
    "firmware_hash": { "type": "string", "pattern": "^[a-fA-F0-9]{64}$" },
    "model_hash": { "type": ["string", "null"], "pattern": "^[a-fA-F0-9]{64}$" },
    "signature": { "type": "string", "minLength": 32, "maxLength": 2048 }
  }
}
